<!DOCTYPE html><html lang="pt"><head ><meta  charset="UTF-8"/><style>
body {
    font-family: sans-serif;
}

section {
    position: relative;
    padding: 1rem;
    border-bottom: black 1px solid;
}
section > button {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
}

blockquote {
    border-left: lightgray 0.2rem solid;
    padding-left: 1.5rem;
    color: #444;
}

table {
    border-collapse: collapse;
    border-top: gray 1px solid;
    border-left: gray 1px solid;
}

tr {
    border-bottom: gray 1px solid;
}

td {
    border-right: gray 1px solid;
}

thead {
    font-weight: bold;
}

thead > tr:nth-child(1) > td:nth-child(3) {
    text-align: center;
}

td {
    min-width: 3rem;
}

td._1 {
    background-color: lightsalmon;
}

td._2 {
    background-color: lightgreen;
}

td._3 {
    background-color: lightpink;
}
</style><title >Potato 1</title></head><body ><h1 >Potato 1</h1><p ><a  href="https://github.com/elisauhura/PotatoChip">Reposit√≥rio no Github</a></p><section  id="_A1800B5A-A223-4D2B-8C9A-F0AF908395AB"><h2 >Proposta</h2><button  onclick="if(document.querySelector('#_A1800B5A-A223-4D2B-8C9A-F0AF908395AB > div').style.display === 'none') { document.querySelector('#_A1800B5A-A223-4D2B-8C9A-F0AF908395AB > div').style.display = ''; document.querySelector('#_A1800B5A-A223-4D2B-8C9A-F0AF908395AB > button').innerHTML='esconder'; } else { document.querySelector('#_A1800B5A-A223-4D2B-8C9A-F0AF908395AB > div').style.display = 'none'; document.querySelector('#_A1800B5A-A223-4D2B-8C9A-F0AF908395AB > button').innerHTML='expandir'; }">esconder</button><div  style=""><p >A arquitetura RISC-V √© um ISA aberta lan√ßada em 2010 que vem ganhando espa√ßo em aplica√ß√µes comerciais.</p><p >A proposta deste TCC √© o desenvolvimento e verifica√ß√£o de um n√∫cleo RISC-V RV32I que seja pequeno e com suporte as extens√µes A, C, Zicsr e Zifencei. O n√∫cleo tem como alvo o seu uso em sistemas embarcados que possuam restri√ß√µes de tamanho f√≠sico ou de custo. Ser√° usado como base projetos como o SERV [1] e PicoRV32 [2] que oferecem n√∫cleos pequenos, por√©m sem o suporte ao conjunto de extens√µes propostas. O suporte ao conjunto proposto permitir√° o uso de instru√ß√µes compactas (que reduz o tamanho dos programas para RISC-V em torno de 30%) bem como o suporte √† execu√ß√£o privilegiada para rodar c√≥digo de terceiros de forma segura.</p><p >Se espera no fim do trabalho a implementa√ß√£o da CPU em Verilog, s√≠ntese da mesma em uma FPGA (Xilinx Artix 7) e um conjunto de softwares que demonstrem o funcionamento do chip al√©m da documenta√ß√£o de todo o projeto.</p><ol ><li ><a  href="https://github.com/olofk/serv">https://github.com/olofk/serv</a></li><li ><a  href="http://github.com/cliffordwolf/picorv32">http://github.com/cliffordwolf/picorv32</a></li></ol></div></section><section  id="_19DC10A9-280E-40A9-86C1-7ED0A33760E7"><h2 >Envolvidos</h2><button  onclick="if(document.querySelector('#_19DC10A9-280E-40A9-86C1-7ED0A33760E7 > div').style.display === 'none') { document.querySelector('#_19DC10A9-280E-40A9-86C1-7ED0A33760E7 > div').style.display = ''; document.querySelector('#_19DC10A9-280E-40A9-86C1-7ED0A33760E7 > button').innerHTML='esconder'; } else { document.querySelector('#_19DC10A9-280E-40A9-86C1-7ED0A33760E7 > div').style.display = 'none'; document.querySelector('#_19DC10A9-280E-40A9-86C1-7ED0A33760E7 > button').innerHTML='expandir'; }">esconder</button><div  style=""><ul ><li >Nina S. T. Hirata (<a  href="https://www.ime.usp.br/~nina/">website</a>) - Respons√°vel</li><li >Alfredo Goldman (<a  href="https://www.ime.usp.br/~gold/">website</a>) - Supervisor</li><li >Carlos Eduardo de Paula (<a  href="https://twitter.com/carlosedp/">@carlosedp</a>) - Mentor</li><li >Elisa Uhura Pereira da Silva (<a  href="https://twitter.com/elisauhura">@elisauhura</a>) - Aluna</li></ul></div></section><section  id="_D6C46E4A-4A66-40BE-976A-2874ABAE9D1A"><h2 >Cronograma</h2><button  onclick="if(document.querySelector('#_D6C46E4A-4A66-40BE-976A-2874ABAE9D1A > div').style.display === 'none') { document.querySelector('#_D6C46E4A-4A66-40BE-976A-2874ABAE9D1A > div').style.display = ''; document.querySelector('#_D6C46E4A-4A66-40BE-976A-2874ABAE9D1A > button').innerHTML='esconder'; } else { document.querySelector('#_D6C46E4A-4A66-40BE-976A-2874ABAE9D1A > div').style.display = 'none'; document.querySelector('#_D6C46E4A-4A66-40BE-976A-2874ABAE9D1A > button').innerHTML='expandir'; }">esconder</button><div  style="overflow-y: scroll;"><table ><thead ><tr ><td rowspan="2">Tarefa</td><td rowspan="2">Status</td><td colspan="13">M√™s</td></tr><tr ><td>jan</td><td>fev</td><td>mar</td><td>abr</td><td>mai</td><td>jun</td><td>jul</td><td>ago</td><td>set</td><td>out</td><td>nov</td><td>dez</td></tr></thead><tbody ><tr ><td >Apreender Verilog</td><td >Completa</td><td  class="_1">1</td><td  class="_1">1</td><td  class="_2">2</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td></tr><tr ><td >Adquirir a FPGA</td><td >Completa</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_1">1</td><td  class="_2">2</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td></tr><tr ><td >Apreender a usar a FPGA</td><td >Completa</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_1">1</td><td  class="_1">1</td><td  class="_2">2</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td></tr><tr ><td >Estudo da arquitetura RISC-V</td><td >Completa</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_1">1</td><td  class="_1">1</td><td  class="_1">1</td><td  class="_1">1</td><td  class="_1">1</td><td  class="_2">2</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td></tr><tr ><td >Preparar ambiente para desenvolvimento</td><td >Completa</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_1">1</td><td  class="_1">1</td><td  class="_1">1</td><td  class="_2">2</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td></tr><tr ><td >Desenvolvimento do n√∫cleo</td><td >Em progresso</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_1">1</td><td  class="_1">1</td><td  class="_3">3</td><td  class="_0"></td></tr><tr ><td >Valida√ß√£o e s√≠ntese do n√∫cleo</td><td >Espera</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_3">3</td><td  class="_3">3</td><td  class="_0"></td></tr><tr ><td >Organiza√ß√£o da documenta√ß√£o</td><td >Em progresso</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_1">1</td><td  class="_3">3</td><td  class="_0"></td></tr><tr ><td >Escrever monografia</td><td >Em progresso</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_1">1</td><td  class="_1">1</td><td  class="_3">3</td><td  class="_0"></td></tr><tr ><td >Poster do TCC</td><td >Espera</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_3">3</td></tr><tr ><td >Apresentar TCC</td><td >Espera</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_3">3</td></tr><tr ><td >Atualiza√ß√£o final</td><td >Espera</td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_0"></td><td  class="_3">3</td></tr></tbody></table><p >Legenda: [1] Em Progresso [2] Concluido [3] Planejado</p></div></section><section  id="_FDFBFAF6-02C0-4B4A-AD7F-7D0BE5592839"><h2 >Log</h2><button  onclick="if(document.querySelector('#_FDFBFAF6-02C0-4B4A-AD7F-7D0BE5592839 > div').style.display === 'none') { document.querySelector('#_FDFBFAF6-02C0-4B4A-AD7F-7D0BE5592839 > div').style.display = ''; document.querySelector('#_FDFBFAF6-02C0-4B4A-AD7F-7D0BE5592839 > button').innerHTML='esconder'; } else { document.querySelector('#_FDFBFAF6-02C0-4B4A-AD7F-7D0BE5592839 > div').style.display = 'none'; document.querySelector('#_FDFBFAF6-02C0-4B4A-AD7F-7D0BE5592839 > button').innerHTML='expandir'; }">esconder</button><div  style=""><h3 >Minutos trabalhados 10630/28800 (36%)</h3><blockquote ><h4 >2021-04-05 (30min) [pre]</h4><p >Batepapo inicial com o Gold para definir o caminho do TCC. Dentre os pontos importantes da conversa podemos listar:</p><ul ><li >Trabalhar com algo relacionado a RISC-V</li><li >Explorar poss√≠veis projetos j√° existentes</li></ul></blockquote><blockquote ><h4 >2021-04-06 (300min) [Verilog]</h4><p >Estudo de Verilog com base no livro Verilog HDL do Samir Palnitkar. Parte dos estudos resultaram em um pequeno projeto com exemplos de integra√ß√£o entre Verilog, C e Objective-C. <a  href="https://github.com/elUrso/ObjV">Link para o reposit√≥rio</a>.</p></blockquote><blockquote ><h4 >2021-04-11 (240min) [pre]</h4><p >Leitura do(s) livro(s) do Patterson e releitura da especifica√ß√£o do RISC-V. Curiosamente, o Patterson j√° est√° dispon√≠vel numa edi√ß√£o que usa o RISC-V.</p></blockquote><blockquote ><h4 >2021-04-27 (240min) [pre]</h4><p >Escrita de um texto sobre os compromissos do RISC-V. <a  href="./compromissos.html">Acesse aqui</a>.</p></blockquote><blockquote ><h4 >2021-05-10 (240min) [pre]</h4><p >Estudo da especifica√ß√£o 0.10 da extens√£o de vetores do RISC-V,seu contexto em rela√ß√£o a outras extens√µes (ARM SVE e Intel AVX-512) e escrita de um breve texto sobre a mesma. <a  href="./RVV.html">Acesse aqui</a>.</p></blockquote><blockquote ><h4 >2021-05-14 (60min) [pre]</h4><p >Ingresso do Carlos Eduardo como mentor no projeto.Ele √© embaixador RISC-V no Brasil e seu conhecimento t√©cnico no assunto √© de grande valor.Realizamos uma conversa acerca do modelo de FPGA a ser comprado e fechamos na Artix 7 da Xilinx.Realizei a aquisic√£o da placa XC7A100T Wukong da QMTECH e um JTAG para realizar a programa√ß√£o.O equipamento deve chegar na metade de junho.</p></blockquote><blockquote ><h4 >2021-05-15 (30min) [pre]</h4><p >Desenvolvimento da proposta e defini√ß√£o de objetivos parciais.</p></blockquote><blockquote ><h4 >2021-06-04 (120min) [FPGA]</h4><p >Teste de configura√ß√£o da FPGA Artix-7. Al√©m da prepara√ß√£o do ambiente (cria√ß√£o de m√°quina virtual e instala√ß√£o do Vivado), realizei os experimentos disponibilizados pelo fabricante da placa (<a  href="https://github.com/ChinaQMTECH/XC7A100T-200T_Wukong_Board">repo aqui</a>).</p><p >Obter a placa foi um processo relativemente tranquilo, exceto pelo fato de eu ter enviado um endere√ßo inv√°lido. Com isso, ao chegar no correios da minha cidade, o pacote √© devolvido para a china ü§Ø. Felizmente dei sorte ao conseguir comprar uma segunda JTAG no Mercado Livre (a primeira est√° voltando pra china) e de recuperar o pacote com a FPGA em si. A li√ß√£o do dia √©: revise o endere√ßo de entrega!</p></blockquote><blockquote ><h4 >2021-06-05 (240min) [FPGA]</h4><p >Finaliza√ß√£o da configura√ß√£o do ambiente de desenvolvimento e estudo das interfaces dispon√≠veis na FPGA.</p></blockquote><blockquote ><h4 >2021-09-01 (300min) [Site]</h4><p >Crian√ß√£o do reposit√≥rio do projeto, design do novo layout do site e prepara√ß√£o do sistema de renderiza√ß√£o dele.</p><p >O sistema basicamente consiste em um render de JSON para HTML extens√≠vel por m√≥dulos. Assim os log de trabalho podem ser registrados de um modo que permita gerar estat√≠sticas e gerar uma p√°gina.</p></blockquote><blockquote ><h4 >2021-09-02 (300min) [Site]</h4><p >Trabalhei nos m√≥dulos necess√°rios para renderizar o website. Isso inclui a renderiza√ß√£o de tags, inje√ß√£o de estilo, cria√ß√£o das se√ß√µes, inje√ß√£o de outros arquivos e listas.</p></blockquote><blockquote ><h4 >2021-09-06 (400min) [Site, Core]</h4><p >Desenvolvimento do m√≥dulo de cronograma e do m√≥dulo de log do site. Prepara√ß√£o de uma folha de estilos b√°sica.</p><p >Design da se√ß√£o de processamento de inteiros do n√∫cleo.</p></blockquote><blockquote ><h4 >2021-09-07 (480min) [Core]</h4><p >Implementa√ß√£o dos m√≥dulos de banco de regitro, ALU e soft RAM incluindo alguns testes.</p></blockquote><blockquote ><h4 >2021-09-08 (90min) [Monografia, Core]</h4><p >Prepara√ß√£o do template da monografia e documenta√ß√£o inical da unidade de controle para a primeira itera√ß√£o do core .</p></blockquote><blockquote ><h4 >2021-09-12 (180min) [Arquitetura]</h4><p >Releitura da especifica√ß√£o do RISC-V para refor√ßo.</p></blockquote><blockquote ><h4 >2021-09-15 (540min) [Simulador, Core]</h4><p >Trabalhei na interface do simulador. Ele ser√° usado para avaliar o comportamento do hardware de forma visual.</p><p >Como desenvolvo em um Mac estou usando a interface nativa e hoje implementei um visualizador para o estado da RAM:</p><img  src="img/sim_001_ram.png" style="object-fit: contain; max-width: 100%;"/><p >Por fim trabalhei no core para que o m√≥dulo de soft RAM funcione a partir do C++ para depois ligar com o vetor em C da UI.</p></blockquote><blockquote ><h4 >2021-09-16 (540min) [Simulador, Core]</h4><p >A interface do simulador ganhou alguns bot√µes, mas apenas Load Program funciona por enquanto.</p><img  src="img/sim_002_ram.png" style="object-fit: contain; max-width: 100%;"/><p >Agora o usu√°rio pode definir o conte√∫do da ram a partir de qualquer arquivo. Tamb√©m √© poss√≠vel editar manualmente os bytes da mem√≥ria e copiar uma regi√£o selecionada.</p><p >Por fim trabalhei na interface C++/C/Obj-C entre a CU1 gerada pelo verilator e a aplica√ß√£o Cocoa. Aproveitando para explicar um pouco como as coisas est√£o organizadas:</p><p >Os arquivos verilog ficam dentro da pasta stepV. Para um m√≥dulo 'X.v' √© poss√≠vel gerar 'testes unit√°rios' a partir do arquivo 'X.unit.cpp' ou uma biblioteca a partir do arquivo 'X.cpp' e sua interface 'X.h'. Por exemplo, para a biblioteca do 'cu1.v' rodamos `$ make cu1.a` e para o 'teste uni√°rio' do 'integer_alu.v' rodamos `$ make integer_alu.unit`.</p></blockquote><blockquote ><h4 >2021-09-17 (300min) [Simulador, Core]</h4><p >Implementei o c√≥digo para fazer com que os outros bot√µes da interface passassem a funcionar.</p><p >Alterei um pouco o makefile do stepV para gerar objetos que funcionem no Xcode. Vale notar que ainda √© necess√°rio linkar no projeto a biblioteca libc++.</p><p >Adicionei o suporte a observa√ß√£o do clock usando o m√©todo poke da API do `cu1`.</p></blockquote><blockquote ><h4 >2021-09-21 (270min) [Core]</h4><p >Trabalhei na implementa√ß√£o parcial do sistema de Fetch-Decode-Execute para suporte ao conjunto base RV32I.</p></blockquote><blockquote ><h4 >2021-09-22 (600min) [Core, Simulador, Bra]</h4><p >Implementei parte das instru√ß√µes base (branch, alu, jump). Adicionei log do valor de registradores no simulador. Adicionei -i instru√ß√µes no BRA.</p></blockquote><blockquote ><h4 >2021-09-23 (600min) [Core, Simulador, Bra]</h4><p >Implementei parte das instru√ß√µes base (load, store). Preparei a toolchain de risc-v para compilar programas em C. Adicionei quase todas as instru√ß√µes RV32I no BRA.</p></blockquote><blockquote ><h4 >2021-09-24 (660min) [Core, Arquitetura]</h4><p >Resolvi um bug na instru√ß√£o jal. Avaliei qual ser√° o m√©todo inical de interface do sistema e dentre as op√ß√µes optei por utilizar comunica√ß√£o UART pela simplicidade. Estudei a parte privilegiada da especifica√ß√£o do RISC-V para implemetar a parte de CSR.</p></blockquote><blockquote ><h4 >2021-09-26 (300min) [Projeto]</h4><p >Reorganizei a estrutura do projeto para trabalhar pelo Xcode. Continuei os estudos de arquitetura privilegiada. Comecei a estruturar vers√£o final de testes.</p></blockquote><blockquote ><h4 >2021-09-27 (300min) [Projeto]</h4><p >Trabalhei no rework da unidade de controle para ter suporte a CSRs.</p></blockquote><blockquote ><h4 >2021-09-28 (300min) [Projeto]</h4><p >Trabalhei no sistema de testes integrado ao Xcode.</p></blockquote><blockquote ><h4 >2021-09-29 (720min) [Core, Projeto]</h4><p >Corrigi um bug no memory_fetch. Avancei o rework do control_unit que agora suport instru√ß√µes dos opcodes LUI, AIUPC, OP e OP-IMM.</p><p >Agora o workflow ocorre marjoriariamente no Xcode, exceto pela programa√ß√£o em Verilog pois o editor n√£o tem suport a hints nem a colora√ß√£o da sintaxe.</p><p >Isso foi poss√≠vel com a adi√ß√£o de tracing aos m√≥dulos compilados e a adi√ß√£o da classe UHRTestBench que permite executar a simula√ß√£o a partir de uma s√©rie de transforma√ß√µes e constrains. Considere o snippet a seguir:</p><pre >@8: @{
	@"applyOnRise": @[
		@(UHRControlUnitSignalMI_R), @1,
		@(UHRControlUnitSignalMI_D), @0xdeadbeef
	]
},
@9: @{
	@"checkOnLow": @[
		@(UHRControlUnitSignalINST), @0xdeadbeef,
		@(UHRControlUnitSignalSTATE), @(UHRControlUnitStateExecute)
		]
},
@10: @{
	@"pass": @{}
}</pre><p >A chave indica em qual clock que as regras devem ser aplicadas. As regras dispon√≠veis s√£o applyOnRise e applyOnFall para simular est√≠mulos, checkOnLow e checkOnHigh para aplicar constrains e pass para encerrar a simula√ß√£o. Se algum constrain falhar, uma falha √© emitida para o sistema de testes e a simula√ß√£o cont√≠nua at√© um pass ou chegar no limite de clocks pr√© definidos pelo usu√°rio.</p></blockquote><blockquote ><h4 >2021-09-30 (660min) [Core, Projeto]</h4><p >Implentei o resto das instru√ß√µes que estavam dispon√≠veis na vers√£o anterior do core e comecei a reestruturar o PI Sim para executar programas de teste.</p></blockquote><blockquote ><h4 >2021-10-01 (480min) [Core, Simulador, Projeto]</h4><p >Configurei a CI do Xcode para fazer com que os testes sejam executados a cada commit. Reorganizei a parte gr√°fica do simulador e sua integra√ß√£o com os m√≥dulos de simula√ß√£o.</p></blockquote><blockquote ><h4 >2021-10-04 (480min) [Monografia]</h4><p >Comecei a escrever a introdu√ß√£o da monografia.</p></blockquote><blockquote ><h4 >2021-10-05 (480min) [Monografia]</h4><p >Continuei o trabalho na monografia, principalmente planejando e organizando se√ß√µes da introdu√ß√£o e monografia.</p></blockquote><blockquote ><h4 >2021-10-06 (150min) [Projeto]</h4><p >Comecei a preparar o projeto para uma pequena reorganiza√ß√£o necess√°ria para mitigar bugs no core.</p></blockquote></div></section><p >Check the circuit ‚Äì Spock</p></body></html>